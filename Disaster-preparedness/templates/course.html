<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Earthquake Course</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/course_page.css') }}">
</head>
<body>
  <div class="course-container">
    <h1>ğŸŒ Earthquake Preparedness</h1>
    <p class="subtitle">Learn types of earthquakes and survival strategies.</p>

    <div class="course-section">
      <h2>Types of Earthquakes</h2>
      <ul>
        <li>Tectonic Earthquakes â€“ caused by movement of plates</li>
        <li>Volcanic Earthquakes â€“ linked with volcanic activity</li>
        <li>Collapse Earthquakes â€“ caused by underground collapses</li>
        <li>Explosion Earthquakes â€“ caused by man-made explosions</li>
      </ul>
    </div>
    <section class="course-section">
  <h2>ğŸ“– What Is an Earthquake?</h2>
  <iframe width="560" height="315"
    src="https://www.youtube.com/embed/jlLpZ9S2slQ?enablejsapi=1"
    frameborder="0" allowfullscreen
    data-course="Earthquake"
    data-element="video1"></iframe>
</section>

<section class="course-section">
  <h2>ğŸ›¡ What to Do If Youâ€™re Stuck in an Earthquake</h2>
  <iframe width="560" height="315"
    src="https://www.youtube.com/embed/g-U7U0SCrAo?enablejsapi=1"
    frameborder="0" allowfullscreen
    data-course="Earthquake"
    data-element="video2"></iframe>
</section>


    <div class="course-section">
      <h2>How to Escape in an Earthquake</h2>
      <ul>
        <li>Drop, Cover, and Hold On</li>
        <li>Stay indoors until shaking stops</li>
        <li>Stay away from windows and heavy objects</li>
        <li>If outside, move to an open area away from buildings</li>
      </ul>
    </div>
  </div>
<script src="https://www.youtube.com/iframe_api"></script>
<script>
let players = {};

function onYouTubeIframeAPIReady() {
  // Create players for each iframe
  document.querySelectorAll("iframe[data-element]").forEach((iframe, idx) => {
    const elementId = iframe.getAttribute("data-element");
    const course = iframe.getAttribute("data-course");

    players[elementId] = new YT.Player(iframe, {
      events: {
        'onStateChange': function(event) {
          if (event.data === YT.PlayerState.ENDED) {
            markCompleted(course, elementId);
          }
        }
      }
    });
  });
}

function markCompleted(course, elementId) {
  fetch("/update_progress", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({course: course, element: elementId})
  })
  .then(res => res.json())
  .then(data => console.log("Progress updated:", data));
}
</script>


</body>
</html>
